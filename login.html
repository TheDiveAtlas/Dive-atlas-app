<!DOCTYPE html>
<html>
<head>
  <title>Login - The Dive Atlas</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
      body { 
          font-family: Arial, sans-serif; 
          background-color: #f0f8ff; 
          margin: 0; 
          padding: 20px; 
          display: flex; 
          justify-content: center; 
          align-items: center; 
          min-height: 100vh; 
      }
      .form-container { 
          background: white; 
          padding: 30px; 
          border-radius: 8px; 
          box-shadow: 0 4px 10px rgba(0,0,0,0.1); 
          width: 100%; 
          max-width: 400px; 
      }
      h1 { 
          color: #003366; 
          text-align: center; 
      }
      .form-group { 
          margin-bottom: 15px; 
      }
      label { 
          display: block; 
          margin-bottom: 5px; 
          font-weight: bold; 
          color: #333; 
      }
      input[type="email"], input[type="password"] { 
          width: 100%; 
          padding: 10px; 
          border: 1px solid #ccc; 
          border-radius: 4px; 
          box-sizing: border-box; 
      }
      button { 
          width: 100%; 
          padding: 12px; 
          background-color: #008CBA; 
          color: white; 
          border: none; 
          border-radius: 4px; 
          font-size: 1em; 
          font-weight: bold; 
          cursor: pointer; 
          transition: background-color 0.2s; 
      }
      button:hover { 
          background-color: #005f7a; 
      }
      .create-account-link { 
          text-align: center; 
          margin-top: 15px; 
      }
      .create-account-link a { 
          color: #008CBA; 
          text-decoration: none; 
      }
      .create-account-link a:hover { 
          text-decoration: underline; 
      }
  </style>
</head>
<body>
  <div class="form-container">
    <h1>Login to The Dive Atlas</h1>
    <form id="loginForm">
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required>
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" id="password" name="password" required>
      </div>
      <button type="submit">Login</button>
    </form>
    <div class="create-account-link">
        <p>Don't have an account? <a href="create-account.html">Create one</a></p>
    </div>
  </div>

  <script>
    document.getElementById('loginForm').addEventListener('submit', function(event) {
        event.preventDefault();

        // Use email (and convert to lowercase) for login
        const email = document.getElementById('email').value.toLowerCase();
        const password = document.getElementById('password').value;

        const users = JSON.parse(localStorage.getItem('diveAtlasUsers')) || [];

        // Find user by their email and password
        const user = users.find(u => u.email.toLowerCase() === email && u.password === password);

        if (user) {
            // Login successful
            localStorage.setItem('isLoggedIn', 'true');
            
            // Set the display name based on account type
            const displayName = user.accountType === 'Dive Centre Account' ? user.centreName : user.username;
            localStorage.setItem('loggedInUser', displayName);
            
            // Save the account type to be used on the map page
            localStorage.setItem('loggedInUserType', user.accountType);

            // Redirect to the main map page
            window.location.href = 'index.html';
        } else {
            alert('Invalid email or password.');
        }
    });
  </script>
<!-- Static App Form Collection Script -->
<script src="https://static.app/js/static-forms.js" type="text/javascript"></script>
</body>
</html>